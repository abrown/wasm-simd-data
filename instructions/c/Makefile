# Automatically generated by generate-makefile.py; do not modify.

CFLAGS ?= -O3 --target=wasm32 -msimd128 --no-standard-libraries -Wl,--no-entry
CLANG ?= clang
PYTHON3 ?= python3

SRCS=$(wildcard *.c)
OBJS=$(SRCS:%.c=../wat/%.wasm)
all: $(OBJS)

out/%.wasm: %.c
	-$(CLANG) $(CFLAGS) -Wl,--export=$(subst .,_,$(patsubst %.wasm,%,$(@F))) $< -o $@
	-wasm2wat --enable-simd $@

WASM=$(wildcard out/*.wasm)
WAT=$(WASM:out/%.wasm=out/%.wat)
wat: $(WAT)
out/%.wat: out/%.wasm
	wasm2wat --enable-simd $< -o $@

# TODO clang 12 only can generate 78 of 235 C files

clean:
	rm -rf out
.PHONY: clean
